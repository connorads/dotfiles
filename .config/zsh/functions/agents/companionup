#!/usr/bin/env zsh
# companionup: start Vibe Companion web UI via Tailscale serve
emulate -L zsh

local port=${1:-3456}
local hostname=$(ts status --self --json | jq -r '.Self.DNSName' | sed 's/\.$//')
tmux kill-session -t companion 2>/dev/null
tmux new-session -d -s companion -x 200 -y 50 \
  "PORT=$port the-vibe-companion"
ts serve --bg --https=$port $port
echo "Companion: https://$hostname:$port"
echo "Attach: tmux attach -t companion"

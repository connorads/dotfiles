#!/usr/bin/env zsh
# gigaup: start gigacode server via Tailscale serve
emulate -L zsh

local port=${1:-2468}
local hostname
hostname=$(ts-hostname) || return 1
tmux kill-session -t gigacode 2>/dev/null
tmux new-session -d -s gigacode -x 200 -y 50 \
  "gigacode server --host 127.0.0.1 --port $port --no-token"
ts serve --bg --https=$port $port
echo "Gigacode: https://$hostname:$port"
echo "Inspector: https://$hostname:$port/ui/"
echo "Attach: tmux attach -t gigacode"

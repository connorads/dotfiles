#!/usr/bin/env zsh
# toadup: start toad web UI via Tailscale serve
emulate -L zsh

local port=${1:-8000}
local hostname
hostname=$(ts-hostname) || return 1
tmux kill-session -t toad 2>/dev/null
tmux new-session -d -s toad -x 200 -y 50 \
  "toad serve --host 127.0.0.1 --port $port --public-url https://$hostname:$port"
ts serve --bg --https=$port $port
echo "Toad: https://$hostname:$port"
echo "Attach: tmux attach -t toad"

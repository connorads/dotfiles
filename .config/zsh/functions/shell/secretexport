# secretexport: prompt and export a secret variable
emulate -L zsh
setopt localoptions noxtrace

local name="$1"
if [[ -z "$name" ]]; then
  echo "usage: secretexport VAR_NAME" >&2
  return 1
fi

if [[ ! "$name" =~ ^[A-Za-z_][A-Za-z0-9_]*$ ]]; then
  echo "invalid variable name: $name" >&2
  return 1
fi

local value
read -rs "value?${name}: "
echo
typeset -gx "$name=$value"
unset value

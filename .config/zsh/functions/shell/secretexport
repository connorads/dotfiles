# secretexport: prompt and export a secret variable
emulate -L zsh
setopt localoptions noxtrace

local name="$1"
if [[ -z "$name" ]]; then
  print -u2 "usage: secretexport VAR_NAME"
  return 1
fi

if [[ ! "$name" =~ ^[A-Za-z_][A-Za-z0-9_]*$ ]]; then
  print -u2 "invalid variable name: $name"
  return 1
fi

local value
read -rs "value?${name}: "
echo
typeset -gx "$name=$value"
unset value
